---
# ---------------------------------------------------------
# SECURITY & VALIDATION (FAIL FAST)
# ---------------------------------------------------------
- name: Check hardware requirements
  ansible.builtin.assert:
    that:
      - ansible_processor_vcpus >= rancher_min_vcpus
      - ansible_memtotal_mb >= rancher_min_memory_mb
    fail_msg: "Insufficient hardware: At least {{ rancher_min_vcpus }} vCPUs and {{ rancher_min_memory_mb }} MB of RAM are required."

- name: Verify bootstrap password is defined
  ansible.builtin.assert:
    that:
      - rancher_bootstrap_password is defined
      - rancher_bootstrap_password | length > 0
    fail_msg: "rancher_bootstrap_password variable is required"

- name: Verify password complexity
  ansible.builtin.assert:
    that:
      - rancher_bootstrap_password | length >= 12
      - rancher_bootstrap_password is search("[0-9]")
    fail_msg: "Password too weak. Required: Min 12 characters and at least 1 number."
